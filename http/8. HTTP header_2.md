## 8. HTTP 헤더-캐시와 조건부 요청
### HTTP 캐시
#### 캐시 기본 동작 - 캐시가 없을 때
1. GET /star.jpg 요청한다.
2. 서버는 star.jpg 이미지를 응답한다. (1.1MB) (헤더 0.1M, 바디 1.0M)
3. 또 요청하면 1.1MB의 데이터를 다시 응답한다.
> 로딩 속도 느림, 네트워크 비용 증가, 느린 사용자 경험

#### 캐시 기본 동작 - 캐시 적용
1. 서버에서 cache-control: max-age=60(60초) 헤더를 추가하여 응답한다.
2. 최초 요청 시에는 서버에서 파일을 보내준다. 클라이언트(브라우저)는 캐시에 저장한다.
3. 해당 리소스를 서버에 요청하기 전에, 브라우저에서 찾아 쓴다.
> 장점은 위 캐시가 없을 경우의 반대.

#### 캐시 기본 동작 - 캐시 시간 초과
- 만약 캐시 유효 시간이 초과되면? 당연히 다시 서버에 요청하고, 캐시를 갱신한다.
> 근데, 리소스가 변경되지 않았는데, 캐시가 만료 되었다면.. 또 받을 필요가 있을까?..

### 8-2. 검증 헤더와 조건부 요청
- 캐시 리소스가 만료되었을 때, 경우의 수는 다음 2가지.
- 만료된 캐시 리소스가 진짜 바뀌었을 경우
- 만료된 캐시 리소스가 바뀌지 않았을 경우
> 리소스가 같다는 것을 확인할 수 있는 방법이 필요하다. 이것을 검증 헤더가 수행함.

1. 클라이언트가 헤더에 다음 내용을 추가한다. Last-Modified: 2020/11/10 ...
2. 캐시 유효시간(60초)이 지남.
3. 클라이언트가 if-modified-since: 2020/11/10 ...
4. 서버는 if-modified-since 헤더를 보고, 실제 리소스랑 비교를 해서, 데이터 수정 시간이 동일하면, 리소스가 신선하다고 판단.
5. 서버는 304 Not Modified로 response를 한다. 근데 HTTP Body가 없다.(수정된 것이 없기 때문에)

#### 검증 헤더, 조건부 요청 정리
- Last-Modified: 검증 헤더
- if-modified-since: 조건부 요청
- 캐시 유효시간이 초과해도 데이터 갱신되지 않으면, 304 Not Modified, 헤더 메타 정보만 응답한다.
- 클라이언트는 서버가 보낸 응답 헤더 정보로 캐시의 메타 정보를 갱신
- 클라이언트는 캐시에 저장되어 있는 데이터 재활용
- 결과적으로 네트워크 다운로드가 아닌 HTTP 헤더만 받게 된다.
