# 네트워크 내용 정리
## 네트워크 구성
- DMZ: Demilitarized zone, 외부에 공개하기 위한 네트워크
- SOHO: Small Office, Home Office
> SOHO와 대기업의 네트워크 구성은 다름. 지사가 있는 경우 VPN 필요.
## 프로토콜
- Protocol: 원활하게 통신하기 위한 통신 규약
- OSI 7 Layer: ISO(International Organization for Standardization) 에서 정한 통신 모델
## OSI 7 Layer
7. 응용 계층 (Application Layer)
6. 표현 계층 (Presentation Layer)
5. 세션 계층 (Session)
4. 전송 계층 (Transport)
3. 네트워크 계층 (Network)
2. 데이터 링크 계층 (Data link)
1. 물리 계층 (Physical)
> 하위 계층으로 내려가면서 캡슐화(데이터 전송에 필요한 헤더 추가)
> 상위 계층으로 올라가면서 역캡슐화 한다.
## 1. 물리 계층
- 전송매체를 의미. ex) 0/1 정보를 담은 전파를 전기신호로 변환한다. (랜카드)
- 전송매체 - 유선/무선
- 다이렉트 케이블 : 랜선의 하나로, 단방향 통신, 컴퓨터와 스위치를 연결하는 데 사용하는 케이블
- 크로스 케이블 : 랜선의 하나로, 양방향 통신, PC-PC간 통신을 위한 케이블 (중간에 라인이 꼬여있음)
- 리피터 : 신호를 증폭, 복원하는 기능을 가진 네트워크 중계 장비. 요즘은 다른 네트워크 장비의 기능으로 존재해서 없음.
- 허브 : 신호를 증폭, 복원하는 기능. 여러 PC를 서로 연결할 수 있게 해준다.
  - 허브를 통해 데이터를 특정 PC에 보내려면, 전체 대상으로 보내야 한다. (dummy hub)
- 스위치 : 허브의 dummy한 특성에 대한 대책으로 만든 장비, 
- 
## 2. 데이터 링크 계층
- 데이터 링크 계층: 네트워크 장비 간 신호를 주고받는 규칙을 정하는 계층
- 이더넷: 위 규칙 중 일반적으로 많이 사용되는 규칙으로, 데이터에 목적지 정보를 추가해서 보낸다.
> 이더넷은 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 발생하지 않는 구조로 되어 있다.
> 동시에 데이터를 보내게 되면 충돌이 일어날 수 밖에 없으므로, 보내는 시점을 늦추는 기법(CSMA/CD, Carrier Sense Multiple Access with Collision Detection)를 쓴다.

> 지금은 CSMA/CD는 효율이 안 좋아 사용하지 않고, 스위치 장비를 사용하여 충돌을 막는다.

- MAC 주소: 물리 주소라고도 불림. 랜 카드 제조할 때 새겨지기 때문에, 전 세계에서 유일한 번호로 할당되어 있음.
> 00-23-AE-D9-7A-9A, 앞 3자리는 랜 카드를 만든 제조사 번호, 뒤 3자리는 제조사가 붙인 일련번호임.
> MAC 주소를 이용한 통신에서는 이더넷 헤더와 트레일러를 사용한다.
- 이더넷 헤더: 목적지 MAC주소(6B), 출발지 MAC주소(6B), 유형(2B) 로 구성된다.
- FCS(Frame Check Sequence): 데이터 전송 도중 오류 발생 확인 용도로 사용되는 값
- 프레임(Frame): 이더넷 헤더와 트레일러가 추가된 데이터
> 허브를 통해 데이터를 전송할 때, 목적지 MAC 주소가 도착지와 다르면, 도착지 PC에서는 데이터를 파기한다.

- 스위치(스위칭 허브): MAC 주소 테이블이 내부에 존재(스위치의 각 포트번호 - 포트에 연결된 MAC주소가 등록되는 데이터베이스)하며,
- MAC 주소를 학습하는 기능이 있다. MAC 주소가 학습되지 않은 상태에서 통신할 때는 다른 모든 포트에 전송(플러딩) 한다.

- 데이터 링크 계층에서는 케이블에 데이터가 아무리 많이 전송되어도, 데이터가 충돌하기 않게 하기 위한 장치가 있음.
  - 반이중 통신 방식 : 회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식 (충돌 발생, 허브)
    - 충돌 도메인 : 반이중 통신 방식에서 충돌이 발생할 때 영향이 미치는 범위를 의미
  - 전이중 통신 방식 : 데이터의 송수신을 동시에 통신하는 방식 (충돌 발생하지 않음, 스위치)
  > 스위치는 충돌 도메인의 범위가 좁다..

- ARP(Address Resolution Protocol) : 목적지 컴퓨터의 IP 주소를 이용하여 MAC 주소를 찾기 위한 프로토콜
  - 이더넷 프레임을 보내려면, 목적지 PC의 MAC 주소를 알아야 함.
  - ARP Request: 목적지의 MAC 주소를 알아내기 위해 네트워크에 브로드캐스트 하는 것
  - ARP Table: ARP Request를 통해 알아낸 목적지IP와 MAC주소를 매핑한 테이블.
  > IP 주소가 변경된다면.. MAC 주소도 함께 바뀌므로, 통신 불가.. 따라서, 보존 기간을 ARP 캐시로 지정하고 일정 시간이 지나면 삭제한다.


## 3. 네트워크 계층
- 네트워크 계층: 네트워크 간 통신을 도와주는 계층
- 네트워크 간 통신하려면 라우터 장비가 필요함.
- IP 주소: 어떤 네트워크의 어떤 장치인지 확인해주는 장치
- 네트워크 계층에서는 데이터 앞에 IP 헤더가 붙는다. 여기에는 출발지와 목적지 IP 주소가 포함된다.
- 네트워크 계층의 데이터 단위는 IP 패킷이라고 한다. (데이터 링크 계층에서는 프레임)

- IP 주소 종류
  - IPv4: 32 비트, 43억개 만들 수 있음.
  - IPv6: 128비트, 거의 무한하게 사용할 수 있음.
- 공인 IP 주소는 ISP가 제공함.
- 사설 IP 주소는 주로 회사나 가정의 랜에서 사용함.

- IP 주소는 네트워크 ID와 호스트ID로 나뉘어져 있음.
  - 네트워크 ID: 어떤 네트워크 인지
  - 호스트 ID: 해당 네트워크의 어느 기기인지

- 공인/사설 IP 주소의 범위
  - 공인 IP 주소의 범위와 사설 IP 주소의 범위가 나뉘어져 있다.
  - 사설 IP 주소라고 해서 무조건 192.168.은 아님.

- 네트워크 주소와 브로드캐스트 주소
  - 네트워크 주소: 호스트 ID가 0인 주소
  - 브로드캐스트 주소: 한 번에 데이터 전송하는 데 사용되는 전용 IP 주소
  > 이 두 주소는 기기의 IP로 사용하면 안 됨.

- 서브넷
  - 호스트ID로 사용되던 영역에 서브넷ID를 추가함. (네트워크 ID + 호스트 ID => 네트워크 ID + 서브넷 ID + 호스트 ID)
  - A클래스: 255.0.0.0, B클래스: 255.255.0.0, C클래스: 255.255.255.0
  - 서브넷 마스크: 네트워크 주소와 호스트 주소를 식별하는 값.

- prefix 표기법
  - 서브넷 마스크를 비트 수로 표기하는 것 예) 255.255.255.0 => /24

- 라우터(router)
  - 기본 게이트웨이 설정해야 함.
  - 라우팅 테이블: 경로 정보가 등록되어 있는 테이블
  - 라우팅 프로토콜: 라우터 간 라우팅 정보 교환하기 위한 프로토콜

## 4. 전송 계층
- 전송 계층: 데이터 전송의 신뢰성을 보장하기 위한 계층
- 연결형 통신 (Connection Oriented Communication) : 신뢰성과 정확성이 보장됨 (TCP)
- 비연결형 통신 (Connectionless Communication) : 신뢰성과 정확성이 보장되지 않음 (UDP)

- TCP 헤더: TCP로 전송할 때 붙이는 헤더
- 세그먼트: TCP헤더가 붙은 데이터
- TCP 헤더의 코드 비트(6비트) - 연결의 제어 정보가 기록된다.
  - SYN: 연결 요청
  - ACK: 확인 응답
  - 3-way-handshake
    1. SYN 전송하여 연결 확립 요청
	2. SYN, ACK를 회신하여 연결 확립 응답 및 연결 확립 요청
	3. ACK를 회신하여 연결 확립 응답
	4. FIN을 보내서 연결 종료 요청
	5. FIN에 대한 ACK를 보내서 연결 종료에 대한 응답

- 일련번호(Sequence Number)와 확인 응답 번호(Acknowledgement Number) : 3-way-handshake 후에 사용되는 번호
  - 일련번호: 송신 측에서 수신 측에게 이 데이터가 몇 번째 데이터인지 알려준다.
  - 확인 응답 번호: 수신 측이 몇 번째 데이터를 수신했는지 송신 측에 알려준다.
  - 일련번호를 통해 도중에 데이터가 손상되거나 유실되어도 재전송 가능하게 한다.

- 윈도우 크기: 3-way-handshake 후에 송신되는 데이터를 한 번에 얼마나 크게 보낼 수 있는지
> 연속해서 송수신하는 최대 데이터 크기로, 3-way-handshake 시에 서로의 윈도우 크기를 알려준다.

- 포트 번호: 데이터의 목적지가 어떤 프로그램인지 구분하는 역할을 하는 번호
> TCP 헤더에 출발지와 목적지 포트 번호가 있다(16비트씩)
> 0~1023은 well-known port, 1025이상은 랜덤 포트
	